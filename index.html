<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>雲端小助手</title>
  <!-- 載入共用 CSS -->
  <link rel="stylesheet" href="styles.css" />
  <!-- 載入 LIFF SDK -->
  <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
</head>
<body>
  <!-- 動態載入內容會放在這個容器中 -->
  <div id="app">Loading...</div>

  <script>
    const liffId = "2006838266-YvLRJn6m";

    async function init() {
      try {
        await liff.init({ liffId });
        console.log("LIFF init done");

        // 取得 URL 中的 liff.state 參數（例如：/courseDashboard.html）
        const urlParams = new URLSearchParams(window.location.search);
        let page = "studentOverview.html"; // 預設頁面
        if(urlParams.get("liff.state")){
          page = decodeURIComponent(urlParams.get("liff.state")).replace(/^\//, "");
        }
        // 用一個對照表，決定載入哪個內容檔案
        const mapping = {
          "courseDashboard.html": "courseDashboard-content.html",
          "studentOverview.html": "studentOverview-content.html"
        };
        const contentPage = mapping[page] || "studentOverview-content.html";
        loadContent(contentPage);
      } catch(err) {
        console.error("LIFF init error", err);
        document.getElementById("app").innerHTML = "<p>LIFF 初始化錯誤</p>";
      }
    }

    async function loadContent(page) {
      try {
        const response = await fetch(page);
        if (!response.ok) {
          document.getElementById("app").innerHTML = "<p>載入失敗: " + response.statusText + "</p>";
          return;
        }
        const html = await response.text();
        document.getElementById("app").innerHTML = html;
        // ※ 若內容中有需要初始化的程式碼，請在這裡調用對應的初始化函式
      } catch(err) {
        console.error(err);
        document.getElementById("app").innerHTML = "<p>載入錯誤</p>";
      }
    }

    window.onload = init;
  </script>
</body>
</html>
